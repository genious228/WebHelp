import pandas as pd
import translators as ts
import re
from collections import Counter
import nltk
from nltk.corpus import stopwords
from nltk.stem.snowball import SnowballStemmer

nltk.download('stopwords')
nltk.download('wordnet')

import gzip


# const
ERR404 = "404."
ERR400 = "400."
MAX_TO_TRANSLATE = 100000
ADDITIONAL_STOP_WORDS = ["ttt", " "]
TRANSLATION_ERROR = ""
FILTERING_ERROR = ""
ERROR_404 = ""
ERROR_400 = ""


class PreprocessorParsedData:

    @staticmethod
    def _clean_data_df(data: pd.DataFrame):
        data_clear = pd.DataFrame(columns=["url", "words"])

        # 1. Clear data
        for i in range(data.shape[0]):
            lists = data["words"][i]

            raw_text = lists.replace("[", "").replace("]", "").replace("nan", "")
            if not raw_text or ERR404 in raw_text or ERR400 in raw_text:
                continue
            raw_text = (re.sub(r'\d', "", re.sub(r'[^\w\s]', '', raw_text))
                        .replace("  ", " "))

            add_pd = pd.DataFrame([[data["url"][i], raw_text]], columns=["url", "words"])
            data_clear = pd.concat([data_clear, add_pd], ignore_index=True)

        return data_clear

    @staticmethod
    def _get_rus_wordlist(path):
        with gzip.open(path) as f:
            words = f.read().decode().split()
            return words

    @staticmethod
    def _get_words_dict(start_words: str):

        # 1. Split into russian and english words
        r_rus = re.compile("[а-яА-Я]+")
        r_eng = re.compile("[a-zA-Z]+")
        rus = r_rus.findall(start_words)
        eng = r_eng.findall(start_words)

        # 2. Delete all words, which len < 3
        rus_bigwords = [word for word in rus if len(word) > 2]
        eng_bigwords = [word for word in eng if len(word) > 2]

        # 3. Translate english words into russian words
        translated_list = [] + rus_bigwords
        for i in range(len(eng_bigwords) // MAX_TO_TRANSLATE + 1):
            try:
                start = i * MAX_TO_TRANSLATE
                stop = (i + 1) * MAX_TO_TRANSLATE if len(eng_bigwords) > (i + 1) * MAX_TO_TRANSLATE else len(eng_bigwords) + 1
                translated_rus_i = (ts.translate_text(". ".join(eng_bigwords[start:stop]),
                                                     translator='google',
                                                     from_language="en",
                                                     to_language="ru")
                                    .split(". "))

                for wordlist in translated_rus_i:
                    translated_list += wordlist.split(" ")

            except Exception as e:
                print(e)

        # 4. Delete stop-words. Delete strange words (non russian dictionary words)
        filtered_words = []
        rus_wordlist = PreprocessorParsedData._get_rus_wordlist("russian.txt.gz")
        for word in translated_list:
            if word not in stopwords.words('russian'):
                if word in rus_wordlist:
                    filtered_words.append(word)

        # 5. Stemming
        stemmer = SnowballStemmer("russian")
        stemmed_words = [stemmer.stem(word) for word in filtered_words]

        # 6. Return dict(Counter)
        res_dict = dict(Counter(stemmed_words).most_common())
        return res_dict

    @staticmethod
    def preprocess_df(data: pd.DataFrame):
        clean_data = PreprocessorParsedData._clean_data_df(data)
        ERR = "{'браузер': 2, 'ваш': 1, 'работа': 1, 'медлен': 1, 'сво': 1, 'такж': 1, 'может': 1, 'использова': 1, 'хром': 1, 'опер': 1}"
        res_df = pd.DataFrame(columns=["url", "dict"])

        # process all rows in data
        for i in range(clean_data.shape[0]):
            url = clean_data["url"][i]
            words = clean_data["words"][i]
            preprocessed_words_dict = PreprocessorParsedData._get_words_dict(words)
            if ERR not in preprocessed_words_dict:
                concat_df = pd.DataFrame(data=[[url, preprocessed_words_dict]], columns=["url", "dict"])
                res_df = pd.concat([res_df, concat_df])
            else:
                print("DETECTED SLOW BROWSER!")
            print(f"Processed {i}/{clean_data.shape[0]}")

        return res_df


class Preprocessor:

    @staticmethod
    def _get_rus_wordlist(path):
        with gzip.open(path) as f:
            words = f.read().decode().split()
            return words

    @staticmethod
    def _clean_data(raw_text):
        clean_text = " ".join(raw_text)
        clean_text = clean_text.replace("[", "").replace("]", "").replace("nan", "")
        if ERR404 in clean_text:
            print(ERROR_404)
            return ""
        if ERR400 in clean_text:
            print(ERROR_400)
            return ""
        clean_text = (re.sub(r'\d', "", re.sub(r'[^\w\s]', '', clean_text))
                    .replace("  ", " "))
        return clean_text

    @staticmethod
    def _get_words_dict(start_words: str, rus_dictionary_path: str):

        global MAX_TO_TRANSLATE

        # 1. Split into russian and english words
        r_rus = re.compile("[а-яА-Я]+")
        r_eng = re.compile("[a-zA-Z]+")
        rus = r_rus.findall(start_words)
        eng = r_eng.findall(start_words)

        # 2. Delete all words, which len < 3
        rus_bigwords = [word for word in rus if len(word) > 2]
        eng_bigwords = [word for word in eng if len(word) > 2]

        # 3. Translate english words into russian words
        translated_list = [] + rus_bigwords
        for i in range(len(eng_bigwords) // MAX_TO_TRANSLATE + 1):
            try:
                start = i * MAX_TO_TRANSLATE
                stop = (i + 1) * MAX_TO_TRANSLATE if len(eng_bigwords) > (i + 1) * MAX_TO_TRANSLATE else len(eng_bigwords) + 1
                translated_rus_i = (ts.translate_text(". ".join(eng_bigwords[start:stop]),
                                                      translator='google',
                                                      from_language="en",
                                                      to_language="ru")
                                    .split(". "))

                for wordlist in translated_rus_i:
                    translated_list += wordlist.split(" ")

            except Exception as e:
                print(TRANSLATION_ERROR)

        # 4. Delete stop-words. Delete strange words (non russian dictionary words)
        try:
            filtered_words = []
            rus_wordlist = Preprocessor._get_rus_wordlist(rus_dictionary_path)
            for word in translated_list:
                if word not in stopwords.words('russian'):
                    if word in rus_wordlist:
                        filtered_words.append(word)
        except Exception as e:
            print(FILTERING_ERROR)
            filtered_words = translated_list

        # 5. Stemming
        stemmer = SnowballStemmer("russian")
        stemmed_words = [stemmer.stem(word) for word in filtered_words]

        # 6. Return dict(Counter)
        res_dict = dict(Counter(stemmed_words).most_common())
        return res_dict

    @staticmethod
    def preprocess(raw_text_list: list, rus_dictionary_path: str):
        clear_text = Preprocessor._clean_data(raw_text_list)
        res_dict = Preprocessor._get_words_dict(clear_text, rus_dictionary_path)
        return res_dict


if __name__ == "__main__":
    # [url, list_of_words, 0/1]
    #raw_text = ['  авторизоваться  на  проекте', '                 добавить  отзыв', '                 об  отеле', ' выберите язык', ' русский', ' english', ' українська', ' введите отель, город или страну', ' введите отель, город или страну', 'найти', ' все результаты', ' отели', ' бренды', ' районы и места', ' города', ' регионы', ' страны', ' смотреть все совпадения', 'смотреть больше', ' закрыть', ' история поисков', '0', ' избранные туры', '0', ' любимые отели', '0', ' отели в игноре', '0', ' сравнение цен', '0', ' навигация  по  проекту', '             мой  профиль       ', '             сообщения       ', '             интересы       ', '             клуб', '           ', '                 топхотелс           ', '                 тх           ', 'разделы  клуба  топ хотелс', ' лента клуба', ' все сообщения отелей', ' сообщества отелей', ' кто где когда', ' рейтинги отелей', ' рейтинги и номинации', ' участники', ' путешественники', ' про  турагенты', ' гиды', ' отельеры', '             отели       ', '             туры       ', '             подбор  отдыха       ', '  главная', '  о  топхотелс', '  связь', ' закрыть меню', ' публикации  топхотелс', '                 направление поездки           ', '...', ' страна  поездки', 'континенты', '                         изменить  страну                   ', '                         изменить  регион                   ', '                         страны                   ', ' выбрать город', 'регионы', 'все города', 'популярные', 'регионы', ' доступные', ' популярные', 'пляжные', '                     применить               ', '                     закрыть               ', '                     закрыть               ', ' тип размещения', ' не важно', ' типы объектов', ' поиск вариантов               ', ' расширенный  поиск', ' публикации  топ хотелс', 'топ отелей недели', ' топ 100  отелей  мира', ' digital award ', 'подборки хороших отелей', ' спецакции и промо', ' новые открытия отелей отели', '             речные круизы на теплоходе от  fun& sun: что входит в стоимость и есть ли отличия?       ', 'статья', '       ', '         путешествие по нескольким городам - задача не из легких, ведь', '        нужно самостоятельно организовать транспорт и питание, найти жилье и приобрести экскурсии…  что,', '        если мы скажем вам, что это - абсолютная неправда?  благодаря  fun& sun  cruise вы можете', '        отправиться в масштабное путешествие по городам  россии в комфортабельном “отеле на воде” с', '        собственной инфраструктурой, премиальной концепцией питания и увлекательной экскурсионной', '        программой!', '       ', '         в нашей статье обсудим особенности круизного отдыха с  fun& sun и', '        рассмотрим поближе современный круизный теплоход  нижний  новгород 4*.', '             подробнее       ', '                99 999', '           ', '                02.08.2023', '                           ', '             прием заявок на участие в 10 юбилейной премии  russian  hospitality  awards откроется 1 августа       ', 'пресс-релиз', '       ', '         заявочная кампания ежегодной  всероссийской премии в области гостеприимства  russian  hospitality', '         awards 2023 стартует совсем скоро.', '         в этом году нас ждет юбилейный конкурс, который обещает закончиться грандиозной церемонией', '        награждения.  для гостей предусмотрено много сюрпризов и ярких моментов шоу.', '       ', '             подробнее       ', '                99 999', '           ', '                25.07.2023', '                           ', '            10 новых и обновленных отелей в  египте от ведущих брендов 2022-2023       ', ' египет', '             интересные  отели -  египет                       ', '         если вам хоть раз довелось отдыхать в новом отеле, вы никогда не забудете этот ни с чем не сравнимый аромат новизны: стильные интерьеры, функциональные номера, свежая мебель, блестящая сантехника, хрустящее постельное бельё, сверкающая посуда.  новый отель - это как только что отремонтированная квартира: здесь всё радует и рождает множество планов и устремлений.  в этой подборке мы собрали для вас новые бренды, появившиеся на туристической карте  египта в 2022-2023 годах, - вам осталось только выбрать!   ', '             подробнее', '       ', '                0           ', '                11.07.2023', '                           ', '             национальная гостиничная премия: какие отели станут лучшими в 2023 году?       ', 'пресс-релиз', '         продолжается заявочная кампания  национальной гостиничной премии ‒ 2023.  более 300 российских отелей уже заявили о планах вступить в соревнование за самую престижную награду в гостиничной индустрии страны.  с форматом отбора финалистов и победителей премии в 2023 году вы можете ознакомиться в нашей статье.   ', '             подробнее       ', '                99 999', '           ', '                06.07.2023', '                           ', '             новая концепция  signature и эксклюзивные привилегии в  kirman  hotels       ', 'обзор отелей', '       ', '             начиная с летнего сезона 2023 в отелях сети  kirman появилась новая концепция, включающая в', '            себя множество интересных привилегий - от нового способа организации питания и широкого', '            разнообразия развлекательных программ до услуг личного ассистента.  читайте нашу статью, чтобы', '            узнать побольше об отдыхе с  kirman  signature.   ', '             подробнее       ', '                99 999', '           ', '                15.06.2023', '                           ', '             на  мальдивы  в  первый  раз -  что  нужно  знать  туристу       ', 'статья', '       ', '                         лазурный океан, белоснежные бескрайние пляжи, безмятежность и спокойствие, - казалось бы, с', '                        отдыхом на  мальдивах всё просто и понятно.  но, как и к любому другому путешествию, к поездке на', '                         мальдивские острова нужно основательно подготовиться.  какие моменты нужно учесть,чтобы отдых', '                        принёс максимум радости?  давайте разбираться.   ', '             подробнее       ', '                99 999', '           ', '                09.06.2023', '                           ', '             мальдивский  марафон 2023       ', 'анонс', '         обучаем турагентов тонкостям работы с направлением и вдохновляем туристов на красивый и комфортный отдых на  мальдивских островах. с 05 по 21 июня 2023   ', '             подробнее       ', '                99 999', '           ', '                05.06.2023', '                           ', '             отдых  в  концепции “ два  в  одном”  в  the  x  belek       ', 'обзор отелей', '         в июне 2023 года в  белеке откроется  the  x  belek - курортный отель с по-настоящему уникальной концепцией.  одна половина отеля будет предназначена для семейного отдыха, а другая будет работать в концепции  adults  only.   ', '             подробнее       ', '                99 999', '           ', '                23.05.2023', '                           ', '             akra  hotels - грандиозное открытие нового бренда отелей!       ', 'пресс-релиз', '       ', '                 турецкая сеть отелей  barut  hotels', '                объявила о создании концепции под лейблом  akra  hotels.  новая концепция объединит в себе 6', '                курортных отелей, расположенных в разных уголках  турции.', '               ', '             подробнее       ', '                99 999', '           ', '                18.05.2023', '                           ', '             gamyam  beach  resort -  отдых для тела и души       ', 'обзор отелей', '  gamyam  beach  resort - это новый курортный отель, который расположился на северном побережье', '            штата  карнатака в  индии.  этот отель уникален тем, что помимо стандартных сервисов и услуг, он', '            дает гостям возможность познакомиться с аюрведическим лечением и пройти традиционную', '            оздоровительную программу.', '               ', '             подробнее       ', '                99 999', '           ', '                26.04.2023', '                           ', '             куда  поехать  отдыхать  весной- летом 2023?       ', 'анонс', '         рассказываем с 03 по 14 апреля 2023 в прямых эфирах в рамках ежегодной онлайн-выставки  top hotels', '                        для туристов и турагентов -  on  exhibit “ тревел-тренды сезона.  весна- лето 2023.”  в мероприятии', '                        примут участие эксперты туротрасли и представители отелей из  турции,  египта,  оаэ,  кипра,', '                         мальдив,  таиланда и др.стран.   ', '             подробнее       ', '                99 999', '           ', '                02.04.2023', '                           ', '             объявлены победители премии  russian  hospitality  awards 2022       ', 'пресс-релиз', '         ix торжественная церемония награждения лучших отелей страны  russian  hospitality  awards 2022 состоялась 7 марта в  hyatt  regency  petrovsky  park  moscow. в этом году объекты соревновались в 24 номинациях, в финал вышли 119 претендентов: лучших гостиниц и генеральных менеджеров со всей  россии.  как победители, так и финалисты получили свои заветные награды.   ', '             подробнее       ', '                99 999', '           ', '                13.03.2023', '                           ', '             топ 10 отелей  египта в которых будет интересно детям       ', ' египет', '             интересные  отели -  египет            ,\xa0\xa0 бизнес           ', '         выбор отеля для отдыха с детьми - задача нетривиальная.  питание, развлечение, тёплые бассейны и безопасное море, - хочется учесть всё по максимуму, ведь большое количество радостей и удобств для детей - залог отличного отдыха их родителей.  египет вот уже нескольких десятилетий отлично справляется с поставленной задачей.  ласковое море, отели с большими территориями и развитой детской инфраструктурой - это то, что заставляет семьи с детьми всех возрастов возвращаться сюда снова и снова!   ', '             подробнее', '       ', '                99 999', '           ', '                28.02.2023', '                           ', '             fushifaru  maldives 5* -  ваши  лучшие  фото  из  отпуска       ', 'обзор отелей', '         для многих туристов охота за сочными кадрами становится отдельной формой отпускного приключения - и здесь очень важно выбрать правильную локацию!  хотите вместо обычных и заурядных отпускных фото пополнить свой альбом фотографиями себя в окружении гигантских скатов?  а может, на качелях, стоящих на дне океана?  в нашей статье мы собрали 7 самых необычных локаций для фото, которые можно найти на территории бутик-отеля  fushifaru  maldives 5*.   ', '             подробнее       ', '                99 999', '           ', '                01.02.2023', '                           ', '             топ 10 отелей для отдыха вдвоем в  египте       ', ' египет', '             интересные  отели -  египет            ,\xa0\xa0 бизнес           ', '         отдых формата “только для взрослых” - это не только популярный туристический тренд, но и вполне понятное желание.  будь то тихий спокойный отдых вдвоём или шумный отрыв в компании друзей - полная перезагрузка без детских криков и суеты порой нужна даже самым любящим родителям.  мы подготовили для вас  топ-10 отелей в  египте, в которых взрослым будет по-настоящему комфортно, - просто выберите свой и пакуйте чемоданы!   ', '             подробнее', '       ', '                99 999', '           ', '                31.01.2023', '                           ', '             объявлены финалисты премии  russian  hospitality  awards 2022       ', 'пресс-релиз', '        12 ноября был объявлен список финалистов одной из важнейших премий в сфере гостеприимства -  russian  hospitality  awards 2022. 119 претендентов, отобранных на основе оценок членов жюри и проверок тайными гостями, будут соревноваться в 24 номинациях.   ', '             подробнее       ', '                99 999', '           ', '                16.01.2023', '                           ', '             лучшие  отели  страны  названы  на  национальной  гостиничной  премии 2022       ', 'пресс-релиз', '        25 ноября в московском  центре международной торговли состоялась торжественная церемония награждения победителей  национальной гостиничной премии 2022.  на долгожданной церемонии были объявлены победители в 38 категориях, выбранные по результатам трехэтапного голосования.   ', '             подробнее       ', '                99 999', '           ', '                13.12.2022', '                           ', '             отели  турции для встречи  нового  года       ', ' турция', '             интересные  отели -  турция                       ', '         в гостеприимных отелях  турции хорошо и летом и зимой.  здесь легко устроить замечательные новогодние каникулы и на несколько дней погрузиться в атмосферу беззаботного веселья: пятизвездочные курорты приготовили  множество развлечений для взрослых и детей, увлекательные программы и изысканные угощения.  а мы собрали лучшие из новогодних предложений для вас.   ', '             подробнее', '       ', '                0           ', '                12.12.2022', '                           ', '             отели  мальдив для веселой встречи  нового  года       ', ' мальдивы', '             интересные  отели -  мальдивы                       ', '         отпраздновать  новый год на  мальдивах - отличная идея для тех, кто любит экзотику и умеет отдыхать. \r', ' и кто сказал, что кругом обязательно должны быть сугробы? \r', ' новый год и на  мальдивах –  новый год: праздничные развлечения, рождественские атрибуты и угощения создадут атмосферу волшебства и настоящего веселья.  мы собрали для вас лучшие предложения мальдивских курортов, чтобы встреча  нового  года была незабываемой.   ', '             подробнее', '       ', '                0           ', '                06.12.2022', '                           ', '             топ 10 отелей 3* и 4*  анталийского побережья для зимнего отдыха       ', ' турция', '             интересные  отели -  турция            ,\xa0\xa0 море и пляжи           ', '         турция радует туристов в любое время года, а зимой - особенно: яркие экскурсии, выгодный шоппинг, полезные спа-процедуры.  добавьте сюда демократичные цены на туры и развлечения на месте, комфортную погоду и отсутствие толп туристов - то, что нужно для качественной перезагрузки!   ', '             подробнее', '       ', '                99 999', '           ', '                22.11.2022', '                           ', '             объявлены  победители  премии  russian  hospitality  awards 2021       ', 'пресс-релиз', '         viii торжественная церемония награждения лучших отелей страны  russian  hospitality  awards 2021 состоялась 27 мая в  radisson  blu  olympiysky  hotel  moscow. 23 номинации самой ожидаемой премии года, 116 претендентов на победу, лучших отелей и генеральных менеджеров  россии, съехались в  москву, чтобы узнать, кто из них вернется домой с заветной наградой.   ', '             подробнее       ', '                99 999', '           ', '                13.09.2022', '                           ', '             национальная  гостиничная  премия:  особенности  конкурса 2022       ', 'пресс-релиз', '         прием заявок на национальную  гостиничную премию продолжается до конца сентября.  в этом году количество заявок увеличилось на 30% и уже в ноябре станут известны победители номинаций.  в статье рассказываем о том, как текущие туристические реалии повлияли на конкурс и что отличает премию в этом году.   ', '             подробнее       ', '                99 999', '           ', '                09.09.2022', '                           ', '             топ 10  семейных отелей  сиде ( турция) с хорошим рейтингом       ', ' турция', '             интересные  отели -  турция            ,\xa0\xa0 семья и дети           ', '         сиде по праву считается одним из самых "детских" курортов  турции.  живописные пейзажи, целебный воздух, относительно недолгий трансфер от аэропорта, широкие пляжи с комфортным заходом в море, большой выбор отелей с развитой детской инфраструктурой, а также множество радостей для уставших родителей, - то, что нужно для беззаботного отдыха с детьми!   ', '             подробнее', '       ', '                99 999', '           ', '                08.09.2022', '                           ', '             национальная  гостиничная  премия 2022       ', 'пресс-релиз', '         национальная гостиничная премия проводится в 2022 г в четвертый раз.  с каждым годом профессиональный конкурс вызывает все больший интерес как у участников рынка, так и у отечественных туристов.  пользователи ресурса теперь имеют возможность не только познакомиться с лучшими представителями отрасли, но и напрямую забронировать номер в любом из отелей-номинантов непосредственно на сайте.  бронирование осуществляется без комиссии для отелей и каких-либо дополнительных платежей для гостей.   ', '             подробнее       ', '                99 999', '           ', '                01.07.2022', '                           ', '             delta  hotels by  marriott  jumeirah  beach,  dubai приглашает гостей в восточную сказку       ', 'обзор отелей', '         местоположение отеля обеспечит, пожалуй, идеальный отдых в', '                        оаэ.  здесь есть все как для пар, так и для семей с детьми.  отель подойдет для любителей', '                       пляжного отдыха, а также тех, кто предпочитает активный отдых с экскурсиями.  кроме того,', '                       отель будет рад встречи с домашними питомцами.   ', '             подробнее       ', '                99 999', '           ', '                28.02.2022', '                           ', '                        показать ещё 20 статей                   ', ' все страны', ' абхазия                           ', '                                 австралия                           ', '                                 австрия                           ', '                                 азербайджан                           ', '                                 албания                           ', '                                 алжир                           ', '                                 американское  самоа                           ', '                                 америк.  виргинские о-ва                           ', '                                 ангилья                           ', '                                 ангола                           ', '                                 андорра                           ', '                                 антарктида                           ', '                                 антигуа и  барбуда                           ', '                                 антильские о-ва                           ', '                                 аргентина                           ', '                                 армения                           ', '                                 аруба                           ', '                                 афганистан                           ', ' багамы                           ', '                                 бангладеш                           ', '                                 барбадос                           ', '                                 бахрейн                           ', '                                 беларусь                           ', '                                 белиз                           ', '                                 бельгия                           ', '                                 бенин                           ', '                                 бермудские о-ва                           ', '                                 болгария                           ', '                                 боливия                           ', '                                 босния и  герцеговина                           ', '                                 ботсвана                           ', '                                 бразилия                           ', '                                 брит.  виргинские о-ва                           ', '                                 бруней                           ', '                                 буркина- фасо                           ', '                                 бурунди                           ', '                                 бутан                           ', ' вануату                           ', '                                 ватикан                           ', '                                 великобритания                           ', '                                 венгрия                           ', '                                 венесуэла                           ', '                                 восточный  тимор                           ', '                                 вьетнам                           ', ' габон                           ', '                                 гаити                           ', '                                 гайана                           ', '                                 гамбия                           ', '                                 гана                           ', '                                 гваделупа                           ', '                                 гватемала                           ', '                                 гвинея                           ', '                                 гвинея  бисау                           ', '                                 германия                           ', '                                 гибралтар                           ', '                                 гондурас                           ', '                                 гренада                           ', '                                 греция                           ', '                                 грузия                           ', ' дания                           ', '                                 джибути                           ', '                                 доминика                           ', '                                 доминикана                           ', ' египет                           ', ' замбия                           ', '                                 западная  сахара                           ', '                                 зимбабве                           ', ' израиль                           ', '                                 индия                           ', '                                 индонезия                           ', '                                 иордания                           ', '                                 ирак                           ', '                                 иран                           ', '                                 ирландия                           ', '                                 исландия                           ', '                                 испания                           ', '                                 италия                           ', ' йемен                           ', ' кабо- верде                           ', '                                 казахстан                           ', '                                 каймановы о-ва                           ', '                                 камбоджа                           ', '                                 камерун                           ', '                                 канада                           ', '                                 катар                           ', '                                 кения                           ', '                                 кипр                           ', '                                 кипр ( северный)                           ', '                                 китай                           ', '                                 кокосовые ( килинг) о-ва                           ', '                                 колумбия                           ', '                                 коморские о-ва                           ', '                                 конго                           ', '                                 королевство  тонга                           ', '                                 коста- рика                           ', '                                 кот-д’ ивуар                           ', '                                 куба                           ', '                                 кувейт                           ', '                                 кука о.                           ', '                                 кыргызстан                           ', '                                 кюрасао о.                           ', ' лаос                           ', '                                 латвия                           ', '                                 лесото                           ', '                                 либерия                           ', '                                 ливан                           ', '                                 ливия                           ', '                                 литва                           ', '                                 лихтенштейн                           ', '                                 люксембург                           ', ' маврикий                           ', '                                 мавритания                           ', '                                 мадагаскар                           ', '                                 македония                           ', '                                 малави                           ', '                                 малайзия                           ', '                                 мали                           ', '                                 мальдивы                           ', '                                 мальта                           ', '                                 марианские о-ва                           ', '                                 марокко                           ', '                                 мартиника                           ', '                                 маршалловы о-ва                           ', '                                 мексика                           ', '                                 микронезия ( фшм)                           ', '                                 мозамбик                           ', '                                 молдова                           ', '                                 монако                           ', '                                 монголия                           ', '                                 мьянма ( бирма)                           ', ' намибия                           ', '                                 независимое  государство  самоа                           ', '                                 непал                           ', '                                 нигер                           ', '                                 нигерия                           ', '                                 нидерланды                           ', '                                 никарагуа                           ', '                                 ниуэ                           ', '                                 новая  зеландия                           ', '                                 новая  каледония                           ', '                                 норвегия                           ', ' оаэ                           ', '                                 оман                           ', ' пакистан                           ', '                                 палестина                           ', '                                 панама                           ', '                                 папуа  новая  гвинея                           ', '                                 парагвай                           ', '                                 перу                           ', '                                 польша                           ', '                                 португалия                           ', '                                 пуэрто- рико                           ', ' республика  кирибати                           ', '                                 республика  косово                           ', '                                 республика  палау                           ', '                                 реюньон                           ', '                                 россия                           ', '                                 руанда                           ', '                                 румыния                           ', ' сальвадор                           ', '                                 сан- марино                           ', '                                 сан- томе и  принсипи                           ', '                                 саудовская  аравия                           ', '                                 свазиленд                           ', '                                 северная  корея                           ', '                                 сейшелы                           ', '                                 сен- бартельми                           ', '                                 сенегал                           ', '                                 сен- мартен                           ', '                                 сен- пьер и  микелон                           ', '                                 сент- винсент и  гренадины                           ', '                                 сент- китс и  невис                           ', '                                 сент- люсия                           ', '                                 сербия                           ', '                                 сингапур                           ', '                                 сирия                           ', '                                 словакия                           ', '                                 словения                           ', '                                 соломоновы о-ва                           ', '                                 сомали                           ', '                                 судан                           ', '                                 суринам                           ', '                                 сша                           ', '                                 сьерра- леоне                           ', ' таджикистан                           ', '                                 таиланд                           ', '                                 тайвань                           ', '                                 танзания                           ', '                                 теркс и  кайкос                           ', '                                 того                           ', '                                 тринидад  и  тобаго                           ', '                                 тувалу                           ', '                                 тунис                           ', '                                 туркменистан                           ', '                                 турция                           ', ' уганда                           ', '                                 узбекистан                           ', '                                 украина                           ', '                                 уругвай                           ', ' фиджи                           ', '                                 филиппины                           ', '                                 финляндия                           ', '                                 франция                           ', '                                 французская  гвиана                           ', '                                 французская  полинезия                           ', ' хорватия                           ', ' центрально- африканская  республика                           ', ' чад                           ', '                                 черногория                           ', '                                 чехия                           ', '                                 чили                           ', ' швейцария                           ', '                                 швеция                           ', '                                 шри- ланка                           ', ' эквадор                           ', '                                 экваториальная  гвинея                           ', '                                 эритрея                           ', '                                 эстония                           ', '                                 эфиопия                           ', ' юар                           ', '                                 южная  корея                           ', '                                 южная  осетия                           ', '                                 южный  судан                           ', ' ямайка                           ', '                                 япония                           ', ' найти', ' смотреть все совпадения', 'закрыть', '                         топхотелс                   ', ' о  проекте', ' информация  о  топхотелс', ' путешественникам', ' отельерам', ' турагентам', ' api  сервисы', ' реклама', ' топовый информационный рейтинг отелей', '                     ежегодно более 60 млн. путешественников делают свой выбор отелей на основе информации и', '                        рейтингов,', '                        представленных на проекте.  по посещаемости  топ хотелс уверенно входит в  топ самых популярных', '                        туристических ресурсов.  постоянными посетителями сайта являются как обычные туристы, так и', '                        менеджеры', '                        туристических компаний и отельеры.                   ', ' обратная  связь  с  топхотелс', ' написать  сообщение', 'обратная связь', ' информационные  каналы', '                         подписаться  на  телеграм                       ', ' наши  группы  в  соцсетях', ' работа  на  проекте', ' смотреть  вакансии', '©  tophotels 2003-2023', ' смотреть правила пользования', '                 все права защищены.  перепечатка, включение информации, содержащейся в рекламных и иных', '                материалах сайта,', '                во всевозможные базы данных для дальнейшего их коммерческого использования, размещение таких', '                материалов', '                в любых  сми и  интернете допускаются только с письменного разрешения редакции сайта.', '                 предоставляемый', '                сервис является информационным.  администрация сайта не несет ответственности за достоверность и', '                качество', '                информации, предоставляемой посетителями сайта, в том числе турфирмами и отельерами.', '                 дата введения в действие  пользовательского соглашения — 30.03.2023 год.           ']
    #print(Preprocessor.preprocess(raw_text_list=raw_text, rus_dictionary_path="russian.txt.gz"))
    data_df = pd.read_csv("url_words.csv", header=0, names=["url", "words"])
    df = PreprocessorParsedData.preprocess_df(data_df)
    df.to_csv("res_parse.csv")


